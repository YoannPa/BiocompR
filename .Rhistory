target <- "Negative"
ncores <- 7
DT.target <- methview.qc::devscore.fluo(
RnBSet = result, samples = samples, target = target, ncores = ncores)
DT.target[, `:=`(probe.labels, paste(paste(Description, Index, sep = "."),
" (ID = ", QC.probe.IDs, ")", sep = ""))]
# DT.target <- data.table::dcast(
#   data = DT.target, formula = ... ~ Samples, value.var = "percent.diff.sqrt")
# m_green = data.table:::as.matrix.data.table(x = DT.target[
#   Cyanine == "Cy5 - Dark Red"][, -c(1:11), ], rownames = 1)
DT.target[, Cyanine := as.factor(Cyanine)]
data.table::setattr(x = DT.target$Cyanine, name = "levels",
value = c("Green Channel", "Red Channel"))
molten_dt <- DT.target[, c(14, 12, 13, 1:11), ]
m = molten_dt
tst <- gg2heatmap(
m = m, dendrograms = c(FALSE, TRUE), facet = NULL,
row.type = paste(target, "QC probes measures"),
plot.title = "HM450K deviation score of green channel fluorescence intensities",
dist.method = c("none", "manhattan"),
y.lab = paste(target, "quality control probes"), ncores = ncores,
annot.grps = list("example" = rep(x = "group1", length(samples))),
annot.pal = "red",
scale_fill_grad = scale_fill_gradientn(
colors = c("mediumblue", "mediumblue", "green3", "green3", "red", "red"),
values = rescale(c(-100, -30, -20, 20, 30, 100)), limits = c(-100, 100),
breaks = seq(-100, 100, by = 20),
labels = c("-100%\nor lower", paste0(seq(-80, 80, by = 20), "%"),
"100%\nor higher"), oob = squish, na.value = "black"),
guide_custom_bar = guide_colorbar(
title = "Fluorescence\ndeviation", title.vjust = 0.86,
ticks.linewidth = 2, barwidth = 25),
theme_heatmap = theme(
axis.title.y.left = ggplot2::element_text(size = 14),
axis.text.y.left = ggplot2::element_text(size = 12, colour = "black"),
axis.ticks.y.left = ggplot2::element_line(color = "black"),
axis.title.x = ggplot2::element_text(size = 14),
axis.text.x = element_text(
size = 8, angle = -90, hjust = 0, vjust = 0.5, colour = "black"),
panel.border = element_rect(color = "black", fill = NA, size = 1 )),
na.handle = "keep", verbose = TRUE,
show.annot = FALSE, draw = TRUE, split.by.rows = "Cyanine",
y.axis.right = FALSE)
DT.target
target <- "Bisulfite Conversion II"
ncores <- 7
DT.target <- methview.qc::devscore.fluo(
RnBSet = result, samples = samples, target = target, ncores = ncores)
DT.target[, `:=`(probe.labels, paste(paste(Description, Index, sep = "."),
" (ID = ", QC.probe.IDs, ")", sep = ""))]
# DT.target <- data.table::dcast(
#   data = DT.target, formula = ... ~ Samples, value.var = "percent.diff.sqrt")
# m_green = data.table:::as.matrix.data.table(x = DT.target[
#   Cyanine == "Cy5 - Dark Red"][, -c(1:11), ], rownames = 1)
DT.target[, Cyanine := as.factor(Cyanine)]
data.table::setattr(x = DT.target$Cyanine, name = "levels",
value = c("Green Channel", "Red Channel"))
molten_dt <- DT.target[, c(14, 12, 13, 1:11), ]
m = molten_dt
tst <- gg2heatmap(
m = m, dendrograms = c(FALSE, TRUE), facet = NULL,
row.type = paste(target, "QC probes measures"),
plot.title = "HM450K deviation score of green channel fluorescence intensities",
dist.method = c("none", "manhattan"),
y.lab = paste(target, "quality control probes"), ncores = ncores,
annot.grps = list("example" = rep(x = "group1", length(samples))),
annot.pal = "red",
scale_fill_grad = scale_fill_gradientn(
colors = c("mediumblue", "mediumblue", "green3", "green3", "red", "red"),
values = rescale(c(-100, -30, -20, 20, 30, 100)), limits = c(-100, 100),
breaks = seq(-100, 100, by = 20),
labels = c("-100%\nor lower", paste0(seq(-80, 80, by = 20), "%"),
"100%\nor higher"), oob = squish, na.value = "black"),
guide_custom_bar = guide_colorbar(
title = "Fluorescence\ndeviation", title.vjust = 0.86,
ticks.linewidth = 2, barwidth = 25),
theme_heatmap = theme(
axis.title.y.left = ggplot2::element_text(size = 14),
axis.text.y.left = ggplot2::element_text(size = 12, colour = "black"),
axis.ticks.y.left = ggplot2::element_line(color = "black"),
axis.title.x = ggplot2::element_text(size = 14),
axis.text.x = element_text(
size = 8, angle = -90, hjust = 0, vjust = 0.5, colour = "black"),
panel.border = element_rect(color = "black", fill = NA, size = 1 )),
na.handle = "keep", verbose = TRUE,
show.annot = FALSE, draw = TRUE, split.by.rows = "Cyanine",
y.axis.right = FALSE)
"Bisulfite Conversion I"
ncores <- 7
DT.target <- methview.qc::devscore.fluo(
RnBSet = result, samples = samples, target = target, ncores = ncores)
DT.target[, `:=`(probe.labels, paste(paste(Description, Index, sep = "."),
" (ID = ", QC.probe.IDs, ")", sep = ""))]
# DT.target <- data.table::dcast(
#   data = DT.target, formula = ... ~ Samples, value.var = "percent.diff.sqrt")
# m_green = data.table:::as.matrix.data.table(x = DT.target[
#   Cyanine == "Cy5 - Dark Red"][, -c(1:11), ], rownames = 1)
DT.target[, Cyanine := as.factor(Cyanine)]
data.table::setattr(x = DT.target$Cyanine, name = "levels",
value = c("Green Channel", "Red Channel"))
molten_dt <- DT.target[, c(14, 12, 13, 1:11), ]
m = molten_dt
tst <- gg2heatmap(
m = m, dendrograms = c(FALSE, TRUE), facet = NULL,
row.type = paste(target, "QC probes measures"),
plot.title = "HM450K deviation score of green channel fluorescence intensities",
dist.method = c("none", "manhattan"),
y.lab = paste(target, "quality control probes"), ncores = ncores,
annot.grps = list("example" = rep(x = "group1", length(samples))),
annot.pal = "red",
scale_fill_grad = scale_fill_gradientn(
colors = c("mediumblue", "mediumblue", "green3", "green3", "red", "red"),
values = rescale(c(-100, -30, -20, 20, 30, 100)), limits = c(-100, 100),
breaks = seq(-100, 100, by = 20),
labels = c("-100%\nor lower", paste0(seq(-80, 80, by = 20), "%"),
"100%\nor higher"), oob = squish, na.value = "black"),
guide_custom_bar = guide_colorbar(
title = "Fluorescence\ndeviation", title.vjust = 0.86,
ticks.linewidth = 2, barwidth = 25),
theme_heatmap = theme(
axis.title.y.left = ggplot2::element_text(size = 14),
axis.text.y.left = ggplot2::element_text(size = 12, colour = "black"),
axis.ticks.y.left = ggplot2::element_line(color = "black"),
axis.title.x = ggplot2::element_text(size = 14),
axis.text.x = element_text(
size = 8, angle = -90, hjust = 0, vjust = 0.5, colour = "black"),
panel.border = element_rect(color = "black", fill = NA, size = 1 )),
na.handle = "keep", verbose = TRUE,
show.annot = FALSE, draw = TRUE, split.by.rows = "Cyanine",
y.axis.right = FALSE)
target <- "Bisulfite Conversion I"
ncores <- 7
DT.target <- methview.qc::devscore.fluo(
RnBSet = result, samples = samples, target = target, ncores = ncores)
DT.target[, `:=`(probe.labels, paste(paste(Description, Index, sep = "."),
" (ID = ", QC.probe.IDs, ")", sep = ""))]
# DT.target <- data.table::dcast(
#   data = DT.target, formula = ... ~ Samples, value.var = "percent.diff.sqrt")
# m_green = data.table:::as.matrix.data.table(x = DT.target[
#   Cyanine == "Cy5 - Dark Red"][, -c(1:11), ], rownames = 1)
DT.target[, Cyanine := as.factor(Cyanine)]
data.table::setattr(x = DT.target$Cyanine, name = "levels",
value = c("Green Channel", "Red Channel"))
molten_dt <- DT.target[, c(14, 12, 13, 1:11), ]
m = molten_dt
tst <- gg2heatmap(
m = m, dendrograms = c(FALSE, TRUE), facet = NULL,
row.type = paste(target, "QC probes measures"),
plot.title = "HM450K deviation score of green channel fluorescence intensities",
dist.method = c("none", "manhattan"),
y.lab = paste(target, "quality control probes"), ncores = ncores,
annot.grps = list("example" = rep(x = "group1", length(samples))),
annot.pal = "red",
scale_fill_grad = scale_fill_gradientn(
colors = c("mediumblue", "mediumblue", "green3", "green3", "red", "red"),
values = rescale(c(-100, -30, -20, 20, 30, 100)), limits = c(-100, 100),
breaks = seq(-100, 100, by = 20),
labels = c("-100%\nor lower", paste0(seq(-80, 80, by = 20), "%"),
"100%\nor higher"), oob = squish, na.value = "black"),
guide_custom_bar = guide_colorbar(
title = "Fluorescence\ndeviation", title.vjust = 0.86,
ticks.linewidth = 2, barwidth = 25),
theme_heatmap = theme(
axis.title.y.left = ggplot2::element_text(size = 14),
axis.text.y.left = ggplot2::element_text(size = 12, colour = "black"),
axis.ticks.y.left = ggplot2::element_line(color = "black"),
axis.title.x = ggplot2::element_text(size = 14),
axis.text.x = element_text(
size = 8, angle = -90, hjust = 0, vjust = 0.5, colour = "black"),
panel.border = element_rect(color = "black", fill = NA, size = 1 )),
na.handle = "keep", verbose = TRUE,
show.annot = FALSE, draw = TRUE, split.by.rows = "Cyanine",
y.axis.right = FALSE)
DT.target
tst <- gg2heatmap(
m = m, dendrograms = c(FALSE, TRUE), facet = NULL,
row.type = paste(target, "QC probes measures"),
plot.title = "HM450K deviation score of green channel fluorescence intensities",
dist.method = c("none", "manhattan"),
y.lab = paste(target, "quality control probes"), ncores = ncores,
annot.grps = list("example" = rep(x = "group1", length(samples))),
annot.pal = "red",
scale_fill_grad = scale_fill_gradientn(
colors = c("mediumblue", "mediumblue", "green3", "green3", "red", "red"),
values = rescale(c(-100, -30, -20, 20, 30, 100)), limits = c(-100, 100),
breaks = seq(-100, 100, by = 20),
labels = c("-100%\nor lower", paste0(seq(-80, 80, by = 20), "%"),
"100%\nor higher"), oob = squish, na.value = "black"),
guide_custom_bar = guide_colorbar(
title = "Fluorescence\ndeviation", title.vjust = 0.86,
ticks.linewidth = 2, barwidth = 25),
theme_heatmap = theme(
axis.title.y.left = ggplot2::element_text(size = 14),
axis.text.y.left = ggplot2::element_text(size = 12, colour = "black"),
axis.ticks.y.left = ggplot2::element_line(color = "black"),
axis.title.x = ggplot2::element_text(size = 14),
axis.text.x = element_text(
size = 8, angle = -90, hjust = 0, vjust = 0.5, colour = "black"),
panel.border = element_rect(color = "black", fill = NA, size = 1 )),
na.handle = "keep", verbose = TRUE,
show.annot = FALSE, draw = TRUE, split.by.rows = "QC.probe.IDs",
y.axis.right = FALSE)
tst <- gg2heatmap(
m = m, dendrograms = c(FALSE, TRUE), facet = NULL,
row.type = paste(target, "QC probes measures"),
plot.title = "HM450K deviation score of green channel fluorescence intensities",
dist.method = c("none", "manhattan"),
y.lab = paste(target, "quality control probes"), ncores = ncores,
annot.grps = list("example" = rep(x = "group1", length(samples))),
annot.pal = "red",
scale_fill_grad = scale_fill_gradientn(
colors = c("mediumblue", "mediumblue", "green3", "green3", "red", "red"),
values = rescale(c(-100, -30, -20, 20, 30, 100)), limits = c(-100, 100),
breaks = seq(-100, 100, by = 20),
labels = c("-100%\nor lower", paste0(seq(-80, 80, by = 20), "%"),
"100%\nor higher"), oob = squish, na.value = "black"),
guide_custom_bar = guide_colorbar(
title = "Fluorescence\ndeviation", title.vjust = 0.86,
ticks.linewidth = 2, barwidth = 25),
theme_heatmap = theme(
axis.title.y.left = ggplot2::element_text(size = 14),
axis.text.y.left = ggplot2::element_text(size = 12, colour = "black"),
axis.ticks.y.left = ggplot2::element_line(color = "black"),
axis.title.x = ggplot2::element_text(size = 14),
axis.text.x = element_text(
size = 8, angle = -90, hjust = 0, vjust = 0.5, colour = "black"),
panel.border = element_rect(color = "black", fill = NA, size = 1 )),
na.handle = "keep", verbose = TRUE,
show.annot = FALSE, draw = TRUE, split.by.rows = "Color",
y.axis.right = FALSE)
tst <- gg2heatmap(
m = m, dendrograms = c(FALSE, TRUE), facet = NULL,
row.type = paste(target, "QC probes measures"),
plot.title = "HM450K deviation score of green channel fluorescence intensities",
dist.method = c("none", "manhattan"),
y.lab = paste(target, "quality control probes"), ncores = ncores,
annot.grps = list("example" = rep(x = "group1", length(samples))),
annot.pal = "red",
scale_fill_grad = scale_fill_gradientn(
colors = c("mediumblue", "mediumblue", "green3", "green3", "red", "red"),
values = rescale(c(-100, -30, -20, 20, 30, 100)), limits = c(-100, 100),
breaks = seq(-100, 100, by = 20),
labels = c("-100%\nor lower", paste0(seq(-80, 80, by = 20), "%"),
"100%\nor higher"), oob = squish, na.value = "black"),
guide_custom_bar = guide_colorbar(
title = "Fluorescence\ndeviation", title.vjust = 0.86,
ticks.linewidth = 2, barwidth = 25),
theme_heatmap = theme(
axis.title.y.left = ggplot2::element_text(size = 14),
axis.text.y.left = ggplot2::element_text(size = 12, colour = "black"),
axis.ticks.y.left = ggplot2::element_line(color = "black"),
axis.title.x = ggplot2::element_text(size = 14),
axis.text.x = element_text(
size = 8, angle = -90, hjust = 0, vjust = 0.5, colour = "black"),
panel.border = element_rect(color = "black", fill = NA, size = 1 )),
na.handle = "keep", verbose = TRUE,
show.annot = FALSE, draw = TRUE, split.by.rows = "Evaluate Green",
y.axis.right = FALSE)
tst <- gg2heatmap(
m = m, dendrograms = c(FALSE, TRUE), facet = NULL,
row.type = paste(target, "QC probes measures"),
plot.title = "HM450K deviation score of green channel fluorescence intensities",
dist.method = c("none", "manhattan"),
y.lab = paste(target, "quality control probes"), ncores = ncores,
annot.grps = list("example" = rep(x = "group1", length(samples))),
annot.pal = "red",
scale_fill_grad = scale_fill_gradientn(
colors = c("mediumblue", "mediumblue", "green3", "green3", "red", "red"),
values = rescale(c(-100, -30, -20, 20, 30, 100)), limits = c(-100, 100),
breaks = seq(-100, 100, by = 20),
labels = c("-100%\nor lower", paste0(seq(-80, 80, by = 20), "%"),
"100%\nor higher"), oob = squish, na.value = "black"),
guide_custom_bar = guide_colorbar(
title = "Fluorescence\ndeviation", title.vjust = 0.86,
ticks.linewidth = 2, barwidth = 25),
theme_heatmap = theme(
axis.title.y.left = ggplot2::element_text(size = 14),
axis.text.y.left = ggplot2::element_text(size = 12, colour = "black"),
axis.ticks.y.left = ggplot2::element_line(color = "black"),
axis.title.x = ggplot2::element_text(size = 14),
axis.text.x = element_text(
size = 8, angle = -90, hjust = 0, vjust = 0.5, colour = "black"),
panel.border = element_rect(color = "black", fill = NA, size = 1 )),
na.handle = "keep", verbose = TRUE,
show.annot = FALSE, draw = TRUE, split.by.rows = "Expected Intensity",
y.axis.right = FALSE)
tst <- gg2heatmap(
m = m, dendrograms = c(FALSE, TRUE), facet = NULL,
row.type = paste(target, "QC probes measures"),
plot.title = "HM450K deviation score of green channel fluorescence intensities",
dist.method = c("none", "manhattan"),
y.lab = paste(target, "quality control probes"), ncores = ncores,
annot.grps = list("example" = rep(x = "group1", length(samples))),
annot.pal = "red",
scale_fill_grad = scale_fill_gradientn(
colors = c("mediumblue", "mediumblue", "green3", "green3", "red", "red"),
values = rescale(c(-100, -30, -20, 20, 30, 100)), limits = c(-100, 100),
breaks = seq(-100, 100, by = 20),
labels = c("-100%\nor lower", paste0(seq(-80, 80, by = 20), "%"),
"100%\nor higher"), oob = squish, na.value = "black"),
guide_custom_bar = guide_colorbar(
title = "Fluorescence\ndeviation", title.vjust = 0.86,
ticks.linewidth = 2, barwidth = 25),
theme_heatmap = theme(
axis.title.y.left = ggplot2::element_text(size = 14),
axis.text.y.left = ggplot2::element_text(size = 12, colour = "black"),
axis.ticks.y.left = ggplot2::element_line(color = "black"),
axis.title.x = ggplot2::element_text(size = 14),
axis.text.x = element_text(
size = 8, angle = -90, hjust = 0, vjust = 0.5, colour = "black"),
panel.border = element_rect(color = "black", fill = NA, size = 1 )),
na.handle = "keep", verbose = TRUE,
show.annot = FALSE, draw = TRUE, split.by.rows = "Cyanine",
y.axis.right = FALSE)
samples <- result@pheno[, 1][1:10]
ncores <- 7
DT.target <- methview.qc::devscore.fluo(
RnBSet = result, samples = samples, target = target, ncores = ncores)
DT.target[, `:=`(probe.labels, paste(paste(Description, Index, sep = "."),
" (ID = ", QC.probe.IDs, ")", sep = ""))]
# DT.target <- data.table::dcast(
#   data = DT.target, formula = ... ~ Samples, value.var = "percent.diff.sqrt")
# m_green = data.table:::as.matrix.data.table(x = DT.target[
#   Cyanine == "Cy5 - Dark Red"][, -c(1:11), ], rownames = 1)
DT.target[, Cyanine := as.factor(Cyanine)]
data.table::setattr(x = DT.target$Cyanine, name = "levels",
value = c("Green Channel", "Red Channel"))
molten_dt <- DT.target[, c(14, 12, 13, 1:11), ]
m = molten_dt
tst <- gg2heatmap(
m = m, dendrograms = c(FALSE, TRUE), facet = NULL,
row.type = paste(target, "QC probes measures"),
plot.title = "HM450K deviation score of green channel fluorescence intensities",
dist.method = c("none", "manhattan"),
y.lab = paste(target, "quality control probes"), ncores = ncores,
annot.grps = list("example" = rep(x = "group1", length(samples))),
annot.pal = "red",
scale_fill_grad = scale_fill_gradientn(
colors = c("mediumblue", "mediumblue", "green3", "green3", "red", "red"),
values = rescale(c(-100, -30, -20, 20, 30, 100)), limits = c(-100, 100),
breaks = seq(-100, 100, by = 20),
labels = c("-100%\nor lower", paste0(seq(-80, 80, by = 20), "%"),
"100%\nor higher"), oob = squish, na.value = "black"),
guide_custom_bar = guide_colorbar(
title = "Fluorescence\ndeviation", title.vjust = 0.86,
ticks.linewidth = 2, barwidth = 25),
theme_heatmap = theme(
axis.title.y.left = ggplot2::element_text(size = 14),
axis.text.y.left = ggplot2::element_text(size = 12, colour = "black"),
axis.ticks.y.left = ggplot2::element_line(color = "black"),
axis.title.x = ggplot2::element_text(size = 14),
axis.text.x = element_text(
size = 8, angle = -90, hjust = 0, vjust = 0.5, colour = "black"),
panel.border = element_rect(color = "black", fill = NA, size = 1 )),
na.handle = "keep", verbose = TRUE,
show.annot = FALSE, draw = TRUE, split.by.rows = "Cyanine",
y.axis.right = FALSE)
samples <- result@pheno[, 1][1:100]
ncores <- 7
DT.target <- methview.qc::devscore.fluo(
RnBSet = result, samples = samples, target = target, ncores = ncores)
DT.target[, `:=`(probe.labels, paste(paste(Description, Index, sep = "."),
" (ID = ", QC.probe.IDs, ")", sep = ""))]
# DT.target <- data.table::dcast(
#   data = DT.target, formula = ... ~ Samples, value.var = "percent.diff.sqrt")
# m_green = data.table:::as.matrix.data.table(x = DT.target[
#   Cyanine == "Cy5 - Dark Red"][, -c(1:11), ], rownames = 1)
DT.target[, Cyanine := as.factor(Cyanine)]
data.table::setattr(x = DT.target$Cyanine, name = "levels",
value = c("Green Channel", "Red Channel"))
molten_dt <- DT.target[, c(14, 12, 13, 1:11), ]
m = molten_dt
tst <- gg2heatmap(
m = m, dendrograms = c(FALSE, TRUE), facet = NULL,
row.type = paste(target, "QC probes measures"),
plot.title = "HM450K deviation score of green channel fluorescence intensities",
dist.method = c("none", "manhattan"),
y.lab = paste(target, "quality control probes"), ncores = ncores,
annot.grps = list("example" = rep(x = "group1", length(samples))),
annot.pal = "red",
scale_fill_grad = scale_fill_gradientn(
colors = c("mediumblue", "mediumblue", "green3", "green3", "red", "red"),
values = rescale(c(-100, -30, -20, 20, 30, 100)), limits = c(-100, 100),
breaks = seq(-100, 100, by = 20),
labels = c("-100%\nor lower", paste0(seq(-80, 80, by = 20), "%"),
"100%\nor higher"), oob = squish, na.value = "black"),
guide_custom_bar = guide_colorbar(
title = "Fluorescence\ndeviation", title.vjust = 0.86,
ticks.linewidth = 2, barwidth = 25),
theme_heatmap = theme(
axis.title.y.left = ggplot2::element_text(size = 14),
axis.text.y.left = ggplot2::element_text(size = 12, colour = "black"),
axis.ticks.y.left = ggplot2::element_line(color = "black"),
axis.title.x = ggplot2::element_text(size = 14),
axis.text.x = element_text(
size = 8, angle = -90, hjust = 0, vjust = 0.5, colour = "black"),
panel.border = element_rect(color = "black", fill = NA, size = 1 )),
na.handle = "keep", verbose = TRUE,
show.annot = FALSE, draw = TRUE, split.by.rows = "Cyanine",
y.axis.right = FALSE)
tst <- gg2heatmap(
m = m, dendrograms = c(FALSE, TRUE), facet = NULL,
row.type = paste(target, "QC probes measures"),
plot.title = "HM450K fluorescence deviation score",
dist.method = c("none", "manhattan"),
y.lab = paste(target, "quality control probes"), ncores = ncores,
annot.grps = list("example" = rep(x = "group1", length(samples))),
annot.pal = "red",
scale_fill_grad = scale_fill_gradientn(
colors = c("mediumblue", "mediumblue", "green3", "green3", "red", "red"),
values = rescale(c(-100, -30, -20, 20, 30, 100)), limits = c(-100, 100),
breaks = seq(-100, 100, by = 20),
labels = c("-100%\nor lower", paste0(seq(-80, 80, by = 20), "%"),
"100%\nor higher"), oob = squish, na.value = "black"),
guide_custom_bar = guide_colorbar(
title = "Fluorescence\ndeviation", title.vjust = 0.86,
ticks.linewidth = 2, barwidth = 25),
theme_heatmap = theme(
axis.title.y.left = ggplot2::element_text(size = 14),
axis.text.y.left = ggplot2::element_text(size = 12, colour = "black"),
axis.ticks.y.left = ggplot2::element_line(color = "black"),
axis.title.x = ggplot2::element_text(size = 14),
axis.text.x = element_text(
size = 8, angle = -90, hjust = 0, vjust = 0.5, colour = "black"),
panel.border = element_rect(color = "black", fill = NA, size = 1 )),
na.handle = "keep", verbose = TRUE,
show.annot = FALSE, draw = TRUE, split.by.rows = "Cyanine",
y.axis.right = FALSE)
tst <- gg2heatmap(
m = m, dendrograms = c(FALSE, TRUE), facet = NULL,
row.type = paste(target, "QC probes measures"),
plot.title = "HM450K fluorescence deviation score",
dist.method = c("none", "manhattan"),
y.lab = paste(target, "quality control probes"), ncores = ncores,
annot.grps = list("example" = rep(x = "group1", length(samples))),
annot.pal = "red",
scale_fill_grad = scale_fill_gradientn(
colors = c("mediumblue", "mediumblue", "green3", "green3", "red", "red"),
values = rescale(c(-100, -30, -20, 20, 30, 100)), limits = c(-100, 100),
breaks = seq(-100, 100, by = 20),
labels = c("-100%\nor lower", paste0(seq(-80, 80, by = 20), "%"),
"100%\nor higher"), oob = squish, na.value = "black"),
guide_custom_bar = guide_colorbar(
title = "Fluorescence\ndeviation", title.vjust = 0.86,
ticks.linewidth = 2, barwidth = 25),
theme_heatmap = theme(
axis.title.y.left = ggplot2::element_text(size = 14),
axis.text.y.left = ggplot2::element_text(size = 12, colour = "black"),
axis.ticks.y.left = ggplot2::element_line(color = "black"),
axis.title.x = ggplot2::element_text(size = 14),
axis.text.x = element_text(
size = 8, angle = -90, hjust = 0, vjust = 0.5, colour = "black"),
panel.border = element_rect(color = "black", fill = NA, size = 1 )),
na.handle = "keep", verbose = TRUE,
show.annot = FALSE, draw = TRUE, split.by.rows = NULL,
y.axis.right = FALSE)
tst <- gg2heatmap(
m = m, dendrograms = c(TRUE, TRUE), facet = NULL,
row.type = paste(target, "QC probes measures"),
plot.title = "HM450K fluorescence deviation score",
dist.method = c("manhattan", "manhattan"),
y.lab = paste(target, "quality control probes"), ncores = ncores,
annot.grps = list("example" = rep(x = "group1", length(samples))),
annot.pal = "red",
scale_fill_grad = scale_fill_gradientn(
colors = c("mediumblue", "mediumblue", "green3", "green3", "red", "red"),
values = rescale(c(-100, -30, -20, 20, 30, 100)), limits = c(-100, 100),
breaks = seq(-100, 100, by = 20),
labels = c("-100%\nor lower", paste0(seq(-80, 80, by = 20), "%"),
"100%\nor higher"), oob = squish, na.value = "black"),
guide_custom_bar = guide_colorbar(
title = "Fluorescence\ndeviation", title.vjust = 0.86,
ticks.linewidth = 2, barwidth = 25),
theme_heatmap = theme(
axis.title.y.left = ggplot2::element_text(size = 14),
axis.text.y.left = ggplot2::element_text(size = 12, colour = "black"),
axis.ticks.y.left = ggplot2::element_line(color = "black"),
axis.title.x = ggplot2::element_text(size = 14),
axis.text.x = element_text(
size = 8, angle = -90, hjust = 0, vjust = 0.5, colour = "black"),
panel.border = element_rect(color = "black", fill = NA, size = 1 )),
na.handle = "keep", verbose = TRUE,
show.annot = FALSE, draw = TRUE, split.by.rows = NULL,
y.axis.right = FALSE)
tst <- gg2heatmap(
m = m, dendrograms = c(FALSE, TRUE), facet = NULL,
row.type = paste(target, "QC probes measures"),
plot.title = "HM450K fluorescence deviation score",
dist.method = c("none", "manhattan"),
y.lab = paste(target, "quality control probes"), ncores = ncores,
annot.grps = list("example" = rep(x = "group1", length(samples))),
annot.pal = "red",
scale_fill_grad = scale_fill_gradientn(
colors = c("mediumblue", "mediumblue", "green3", "green3", "red", "red"),
values = rescale(c(-100, -30, -20, 20, 30, 100)), limits = c(-100, 100),
breaks = seq(-100, 100, by = 20),
labels = c("-100%\nor lower", paste0(seq(-80, 80, by = 20), "%"),
"100%\nor higher"), oob = squish, na.value = "black"),
guide_custom_bar = guide_colorbar(
title = "Fluorescence\ndeviation", title.vjust = 0.86,
ticks.linewidth = 2, barwidth = 25),
theme_heatmap = theme(
axis.title.y.left = ggplot2::element_text(size = 14),
axis.text.y.left = ggplot2::element_text(size = 12, colour = "black"),
axis.ticks.y.left = ggplot2::element_line(color = "black"),
axis.title.x = ggplot2::element_text(size = 14),
axis.text.x = element_text(
size = 8, angle = -90, hjust = 0, vjust = 0.5, colour = "black"),
panel.border = element_rect(color = "black", fill = NA, size = 1 )),
na.handle = "keep", verbose = TRUE,
show.annot = FALSE, draw = TRUE, split.by.rows = "Cyanine",
y.axis.right = FALSE)
